package com.duc.smallproject.modaldialog.util;import com.duc.smallproject.modaldialog.model.User;import org.apache.poi.ss.usermodel.CellStyle;import org.apache.poi.xssf.usermodel.*;import javax.servlet.ServletOutputStream;import javax.servlet.http.HttpServletResponse;import java.io.IOException;import java.util.List;public class UserExcelExporter extends AbstractExporter {    private XSSFWorkbook workbook;    private XSSFSheet sheet;    public UserExcelExporter() {        this.workbook = new XSSFWorkbook();    }    private void writeHeaderLine() {        sheet = workbook.createSheet("Users");        XSSFRow row = sheet.createRow(0);        XSSFCellStyle style = workbook.createCellStyle();        XSSFFont font = workbook.createFont();        font.setBold(true);        font.setFontHeight(16);        style.setFont(font);        createCell(row, 0, "User ID", style);        createCell(row, 1, "EMail", style);        createCell(row, 2, "First Name", style);        createCell(row, 3, "Last Name", style);        createCell(row, 4, "Roles", style);        createCell(row, 5, "Enable", style);    }    private void createCell(XSSFRow row, int col, Object value, CellStyle style) {        XSSFCell cell = row.createCell(col);        sheet.autoSizeColumn(col);        if (value instanceof Long) {            cell.setCellValue((Long) value);        }        if (value instanceof Boolean) {            cell.setCellValue((Boolean) value);        }        if (value instanceof String) {            cell.setCellValue((String) value);        }        cell.setCellStyle(style);    }    public void export(List<User> listUsers, HttpServletResponse response) throws IOException {        super.setResponseHeader(response, "application/octet-stream", ".xlsx");        writeHeaderLine();        writeDataLines(listUsers);        ServletOutputStream outputStream = response.getOutputStream();        workbook.write(outputStream);        workbook.close();        outputStream.close();    }    private void writeDataLines(List<User> listUsers) {        int indexRow = 1;        XSSFCellStyle cellStyle = workbook.createCellStyle();        XSSFFont font = workbook.createFont();        font.setFontHeight(14);        cellStyle.setFont(font);        for (User user : listUsers) {            System.out.println(user);            XSSFRow row = sheet.createRow(indexRow++);            int columnIndex = 0;            createCell(row, columnIndex++, user.getId(), cellStyle);            createCell(row, columnIndex++, user.getEmail(), cellStyle);            createCell(row, columnIndex++, user.getFirstName(), cellStyle);            createCell(row, columnIndex++, user.getLastName(), cellStyle);            createCell(row, columnIndex++, user.getRoles().toString(), cellStyle);            createCell(row, columnIndex++, user.isEnabled(), cellStyle);        }    }}